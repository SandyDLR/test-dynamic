<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transifex Live Dynamic Content Demo</title>
    <script src="https://cdn.transifex.com/live.js"></script>
    <script>
        window.liveSettings = {
            api_key: "290ef8bb21e24a3095729db5236bb89a",
            reload_on_language_picker: true
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.6/underscore-min.js"></script>
    <script>
        // Create an alias for Transifex live translateText
        window._t = Transifex.live.translateText;
    </script>
</head>
<body>
    <div id="foo"></div>

    <script type="text/template" id="template">
        <div>
            <h1><%= _t("This is a title") %></h1>
            <p><%= _t("This is a paragraph") %></p>
            <p><%= _t("Hello {name}", params) %></p>
        </div>
    </script>

    <input type="text" id="nameInput" placeholder="Enter name">
    <button onclick="loadDynamicContent()">Load Dynamic Content</button>

    <script>
        function loadDynamicContent() {
            const name = document.getElementById('nameInput').value || "John";
            const params = { name: name };
            const template = _.template(document.getElementById('template').innerHTML);
            document.getElementById('foo').innerHTML = template({ params: params });

            // Mark the newly injected content for translation
            Transifex.live.onReady(function() {
                Transifex.live.translateNode(document.getElementById('foo'));
            });
        }
    </script>
</body>
</html>
